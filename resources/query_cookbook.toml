###
#
# GAQL Query Cookbook
#
# Michael S. Huang (mhuang74@gmail.com)
#
##

# Total Account Traffic Last Week
account_traffic_yesterday = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros 
	FROM customer 
	WHERE 
	  segments.date during yesterday
"""

# Top Keywords
top_keywords_last_week = """
	SELECT
	  customer.id,
	  customer.descriptive_name,
	  campaign.id,
	  campaign.name,
	  campaign.advertising_channel_type,
	  ad_group.id,
	  ad_group.name,
	  ad_group.type,
	  ad_group_criterion.criterion_id,
	  ad_group_criterion.keyword.text,
	  metrics.impressions,
	  metrics.clicks,
	  metrics.cost_micros
	FROM keyword_view
	WHERE
	  segments.date DURING LAST_7_DAYS
	  and metrics.clicks > 10000
	ORDER BY
	  metrics.clicks DESC
	LIMIT 10
"""

# Accounts with Performance Max Campaigns
account_perf_max_campaigns_last_week = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  campaign.id, 
	  campaign.advertising_channel_type, 
	  campaign.name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros,
	  customer.currency_code 
	FROM campaign 
	WHERE 
	  segments.date DURING LAST_7_DAYS 
	  AND campaign.advertising_channel_type IN ('PERFORMANCE_MAX') 
	  AND metrics.clicks > 100
	ORDER BY 
	  metrics.clicks DESC 
	LIMIT 1
"""

# Accounts with Smart Campaigns
account_smart_campaigns_last_week = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  campaign.id, 
	  campaign.advertising_channel_type, 
	  campaign.name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros,
	  customer.currency_code 
	FROM campaign 
	WHERE 
	  segments.date DURING LAST_7_DAYS 
	  AND campaign.advertising_channel_type IN ('SMART') 
	  AND metrics.clicks > 100
	ORDER BY 
	  metrics.clicks DESC 
	LIMIT 1
"""

# Accounts with Local Campaigns
account_local_campaigns_last_week = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  campaign.id, 
	  campaign.advertising_channel_type, 
	  campaign.name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros,
	  customer.currency_code 
	FROM campaign 
	WHERE 
	  segments.date DURING LAST_7_DAYS 
	  AND campaign.advertising_channel_type IN ('LOCAL') 
	  AND metrics.clicks > 100
	ORDER BY 
	  metrics.clicks DESC 
	LIMIT 1
"""

# Accounts with Shopping Campaigns
account_shopping_campaigns_last_week = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  campaign.id, 
	  campaign.advertising_channel_type, 
	  campaign.name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros,
	  customer.currency_code 
	FROM campaign 
	WHERE 
	  segments.date DURING LAST_7_DAYS 
	  AND campaign.advertising_channel_type IN ('SHOPPING') 
	  AND metrics.clicks > 100
	ORDER BY 
	  metrics.clicks DESC 
	LIMIT 1
"""

# Accounts with Multi-Channel Campaigns
account_multichannel_campaigns_last_week = """
	SELECT 
	  customer.id, 
	  customer.descriptive_name, 
	  campaign.id, 
	  campaign.advertising_channel_type, 
	  campaign.name, 
	  metrics.impressions, 
	  metrics.clicks, 
	  metrics.cost_micros,
	  customer.currency_code 
	FROM campaign 
	WHERE 
	  segments.date DURING LAST_7_DAYS 
	  AND campaign.advertising_channel_type IN ('MULTI_CHANNEL') 
	  AND metrics.clicks > 100
	ORDER BY 
	  metrics.clicks DESC 
	LIMIT 1
"""